!function(){"use strict";const e="https://api.kinopoisk.dev/v1.3/movie?selectFields=name&selectFields=videos.trailers.url&selectFields=description&selectFields=poster&selectFields=movieLength&selectFields=persons.name&selectFields=rating&selectFields=watchability&selectFields=year&selectFields=genres&selectFields=id&selectFields=countries.name&";async function t(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":"84S4SNX-Y084WMK-K7FV73W-8G8P6MH"}}),n=await t.json();console.log(n),function(e){const t=document.querySelector(".films");t.innerHTML="";let n=-1;e.docs.forEach((e=>{n++;const c=document.createElement("div");let i="#!",a="";var s;e.watchability.items&&e.watchability.items.length>=1&&('target="_blank"',e.watchability.items.forEach((e=>{e.name,i=e.url}))),c.classList.add("film"),c.innerHTML=`\n          <a href="#" data-id="${n}" class="movie__cover-inner">\n          <img src="${e.poster.url}" alt="${e.name}" class="movie__cover">\n          <div class="movie__cover--darkened"></div>\n      </a>\n      <div class="movie__info">\n          <div class="movie__title">${e.name}</div>\n          <div class="movie__category">${e.genres.map((e=>` ${e.name}`))}</div>\n          <a class="movie__link" href="https://www.ggkinopoisk.ru/film/${e.id}/" target='_blank'>Смотреть бесплатно</a>\n          <div class="movie__average movie__average--${s=e.rating.imdb,s>=8?"green":s>=5?"orange":"red"}">${e.rating.imdb}</div>\n      </div>\n          `,t.appendChild(c)}));const c=document.querySelectorAll(".pagination__btn");e.page<4?c.forEach((t=>{switch(t.dataset.num){case"1":t.innerHTML=1;break;case"2":t.innerHTML=2;break;case"3":t.innerHTML=3;break;case"4":t.innerHTML=4;break;case"5":t.innerHTML=5}t.textContent==e.page&&(document.querySelector(".page-active").classList.remove("page-active"),t.classList.add("page-active"))})):c.forEach((t=>{switch(t.dataset.num){case"1":t.innerHTML=1;break;case"2":t.innerHTML=e.page-1;break;case"3":t.innerHTML=e.page;break;case"4":t.innerHTML=e.page+1;break;case"5":t.innerHTML=e.page+2}t.textContent==e.page&&(document.querySelector(".page-active").classList.remove("page-active"),t.classList.add("page-active"))})),function(e){document.querySelectorAll(".movie__cover-inner").forEach((t=>{t.addEventListener("click",(n=>{n.preventDefault(),function(e){const t=document.querySelector(".popup");document.querySelector(".popup__close").addEventListener("click",(e=>{e.preventDefault(),t.classList.remove("popup--open")})),t.classList.add("popup--open");const n=document.querySelector(".popup__title").querySelector(".title-2"),c=document.querySelector(".film__trailer"),i=document.querySelector(".film__genre");let a="";const s=document.querySelector(".film__countries");let o="";const r=document.querySelector(".film__year"),l=document.querySelector(".film__length"),d=document.querySelector(".film__actors");let m="";const u=document.querySelector(".film__description");n.textContent=e.name,c.src=e.videos.trailers[0].url,e.genres.forEach((e=>a+=`${e.name}, `)),i.textContent=a.slice(0,-2),e.countries.forEach((e=>o+=`${e.name}, `)),s.textContent=o.slice(0,-2),r.textContent=e.year,l.textContent=`${e.movieLength} мин.`;for(let t=0;t<3;t++)m+=`${e.persons[t].name}, `,d.textContent=m.slice(0,-2);u.textContent=e.description}(e[t.dataset.id])}))}))}(e.docs)}(n)}let n;const c=document.querySelectorAll(".genre__title"),i=document.querySelector(".pages");c.forEach((c=>{c.addEventListener("click",(a=>{n=c.dataset.genre;const s=`${e}page=1&limit=30&genres.name=${encodeURIComponent(n)}`;i.classList.add("pages--visible"),t(s)}))})),document.querySelectorAll(".pagination__btn").forEach((c=>{c.addEventListener("click",(i=>{const a=`${e}page=${c.textContent}&limit=30&genres.name=${encodeURIComponent(n)}`;o.scrollIntoView(!0),t(a)}))}));const a=document.querySelector(".form"),s=document.querySelector(".form__input"),o=document.querySelector(".films");a.addEventListener("submit",(n=>{n.preventDefault();const c=`${e}page=1&limit=12&name=${s.value}`;s.value&&(o.scrollIntoView(!0),t(c),s.value="")}));const r=document.querySelector(".btn-search"),l=document.querySelector(".form__submit");r.addEventListener("click",(function(){s.classList.toggle("active"),l.classList.toggle("active"),s.classList.contains("active")?s.focus():s.blur()}))}();