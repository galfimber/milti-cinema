!function(){"use strict";const e="https://api.kinopoisk.dev/v1.3/movie?selectFields=name&selectFields=videos.trailers.url&selectFields=description&selectFields=poster&selectFields=movieLength&selectFields=persons.name&selectFields=rating&selectFields=watchability&selectFields=year&selectFields=genres&selectFields=id&selectFields=countries.name&";async function t(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":"84S4SNX-Y084WMK-K7FV73W-8G8P6MH"}}),s=await t.json();console.log(s),function(e){const t=document.querySelector(".films");t.innerHTML="";let s=-1;e.docs.forEach((e=>{s++;const i=document.createElement("div");let n="#!",a="";var c;e.watchability.items&&e.watchability.items.length>=1&&('target="_blank"',e.watchability.items.forEach((e=>{e.name,n=e.url}))),i.classList.add("film"),i.innerHTML=`\n          <a href="#" data-id="${s}" class="movie__cover-inner">\n          <img src="${e.poster.url}" alt="${e.name}" class="movie__cover">\n          <div class="movie__cover--darkened"></div>\n      </a>\n      <div class="movie__info">\n          <div class="movie__title">${e.name}</div>\n          <div class="movie__category">${e.genres.map((e=>` ${e.name}`))}</div>\n          <a class="movie__link" href="https://www.ggkinopoisk.ru/film/${e.id}/" target='_blank'>Смотреть бесплатно</a>\n          <div class="movie__average movie__average--${c=e.rating.imdb,c>=8?"green":c>=5?"orange":"red"}">${e.rating.imdb}</div>\n      </div>\n          `,t.appendChild(i)}));const i=document.querySelectorAll(".pagination__btn");e.page<4?i.forEach((t=>{switch(t.dataset.num){case"1":t.innerHTML=1;break;case"2":t.innerHTML=2;break;case"3":t.innerHTML=3;break;case"4":t.innerHTML=4;break;case"5":t.innerHTML=5}t.textContent==e.page&&(document.querySelector(".page-active").classList.remove("page-active"),t.classList.add("page-active"))})):i.forEach((t=>{switch(t.dataset.num){case"1":t.innerHTML=1;break;case"2":t.innerHTML=e.page-1;break;case"3":t.innerHTML=e.page;break;case"4":t.innerHTML=e.page+1;break;case"5":t.innerHTML=e.page+2}t.textContent==e.page&&(document.querySelector(".page-active").classList.remove("page-active"),t.classList.add("page-active"))})),function(e){document.querySelectorAll(".movie__cover-inner").forEach((t=>{t.addEventListener("click",(s=>{s.preventDefault(),function(e){const t=document.querySelector(".popup");t.classList.add("popup--open"),document.body.classList.add("no-scroll"),t.innerHTML="";let s="";e.genres.forEach((e=>s+=`${e.name}, `)),s=s.slice(0,-2);let i="";e.countries.forEach((e=>i+=`${e.name}, `)),i=i.slice(0,-2);let n="";for(let t=0;t<3;t++)n+=`${e.persons[t].name}, `;n=n.slice(0,-2);let a="";a=e.videos?`<iframe allowfullscreen class="film__trailer"src="${e.videos.trailers[0].url}"></iframe>`:`<img class="film__trailer" src="${e.poster.url}" alt="poster">`;let c="";null!=e.movieLength&&(c=`${e.movieLength.toString()} мин.`);let l="";l=null!=e.description&&e.description?e.description:"",t.innerHTML=`\n  <div class="popup__body">\n    <div class="popup__header">\n      <div class="popup__title"><h2 class="title-2">${e.name}</h2></div>\n      <a href="#" class="popup__close"><i class="fa-solid fa-xmark"></i></a>\n    </div>\n    <div class="popup__content">\n      ${a}\n      <div class="film__info">\n        <div class="film__genre">${s}</div>\n        <div class="film__countries">${i}</div>\n        <div class="film__year">${e.year}</div>\n        <div class="film__length">${c}</div>\n        <div class="film__actors">${n}</div>\n        <div class="film__description">${l}</div>\n      </div>\n    </div>\n  </div>`,window.addEventListener("click",(e=>{const s=e.target;(!s.closest(".popup__body")&&s.closest(".popup")||s.closest(".popup__close"))&&(e.preventDefault(),t.classList.remove("popup--open"),document.body.classList.remove("no-scroll"))}))}(e[t.dataset.id])}))}))}(e.docs)}(s)}let s;const i=document.querySelectorAll(".genre__title"),n=document.querySelector(".pages");i.forEach((i=>{i.addEventListener("click",(a=>{s=i.dataset.genre;const c=`${e}page=1&limit=30&genres.name=${encodeURIComponent(s)}`;n.classList.add("pages--visible"),t(c)}))})),document.querySelectorAll(".pagination__btn").forEach((i=>{i.addEventListener("click",(n=>{const a=`${e}page=${i.textContent}&limit=30&genres.name=${encodeURIComponent(s)}`;l.scrollIntoView(!0),t(a)}))}));const a=document.querySelector(".form"),c=document.querySelector(".form__input"),l=document.querySelector(".films");a.addEventListener("submit",(s=>{s.preventDefault();const i=`${e}page=1&limit=12&name=${c.value}`;c.value&&(l.scrollIntoView(!0),t(i),c.value="")}));const o=document.querySelector(".btn-search"),r=document.querySelector(".form__submit");o.addEventListener("click",(function(){c.classList.toggle("active"),r.classList.toggle("active"),c.classList.contains("active")?c.focus():c.blur()}))}();